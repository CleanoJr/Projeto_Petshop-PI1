<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>Cadastro pet</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <script src="https://kit.fontawesome.com/ae360af17e.js" crossorigin="anonymous" defer></script>
    <link rel="stylesheet" href="../../static/css/consult_form.css">
    <link rel="shortcut icon" href="../../static/assets/favicon.ico" type="image/x-icon">
</head>
<body>
    {% include '/includes/menu_nav.html'%}
    
    <div class="main">
        <h2>Cadastro pet</h2>
    </div>

    <div class="form-container">
        <div class="card card-form">
            <h4 class="text-left mb-4">Preencha os campos</h4>
            
            <form action="{{ url_for('create_pet') }}" method="POST">
                <input type="hidden" name="client_id" value="{{ client_id }}">
                
                <div id="petForms">
                    <!-- Primeiro formulário do pet -->
                    <div class="pet-group position-relative p-3 mb-2 border rounded">
                        <h5 class="pet-title d-inline-block">Pet 1</h5> 
                        <button type="button" class="btn btn-danger btn-sm position-absolute top-0 end-0 removePet" style="display: none;">X</button>
    
                        <div class="mb-2">
                            <label class="form-label">Nome</label>
                            <input type="text" class="form-control" name="name[]" placeholder="Digite o nome do pet" required>
                        </div>
    
                        <div class="row">
                            <div class="col-md-6 mb-2">
                                <label class="form-label">Espécie</label>
                                <input type="text" class="form-control" name="especie[]" placeholder="Digite a espécie" required>
                            </div>
    
                            <div class="col-md-6 mb-2">
                                <label class="form-label">Raça</label>
                                <input type="text" class="form-control" name="breed[]" placeholder="Digite a raça" required>
                            </div>                        
                        </div>
    
                        <div class="mb-2">
                            <label class="form-label">Nascimento</label>
                            <input type="date" class="form-control" name="birth_date[]" required>
                        </div>
                    </div>
                </div>
    
                <div class="row">
                    <div class="text-center mt-3">
                        <button type="button" class="btn btn-secondary w-50" id="addPet">Adicionar pet</button>
                    </div>
        
                    <div class="text-center mt-3">
                        <button type="submit" class="btn btn-success w-50">Salvar Todos</button>
                    </div>
                </div>
            </form>
        </div>
    </div>
    

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    <script>
        let petCount = 1; // Começa com 1 porque já temos um pet inicial
    
        document.getElementById("addPet").addEventListener("click", function() {
            petCount++; // Incrementa o contador de pets
    
            let petGroup = document.querySelector(".pet-group").cloneNode(true); // Clona o formulário
            petGroup.querySelectorAll("input").forEach(input => input.value = ""); // Limpa os inputs
            
            // Atualiza o título do novo pet
            petGroup.querySelector(".pet-title").textContent = `Pet ${petCount}`;
    
            // Mostra o botão de remover no novo pet
            let removeButton = petGroup.querySelector(".removePet");
            removeButton.style.display = "block";
    
            // Adiciona evento para remover o pet específico
            removeButton.addEventListener("click", function() {
                petGroup.remove();
                updatePetTitles(); // Reorganiza a numeração dos pets
            });
    
            document.getElementById("petForms").appendChild(petGroup);
            updatePetTitles(); // Atualiza a numeração dos pets
        });
    
        function updatePetTitles() {
            let petGroups = document.querySelectorAll(".pet-group");
            petGroups.forEach((group, index) => {
                group.querySelector(".pet-title").textContent = `Pet ${index + 1}`;
            });
            petCount = petGroups.length; // Atualiza a contagem de pets
        }
    </script>
</body>
</html>
